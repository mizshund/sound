<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ã®å‘¨æ³¢æ•°ãƒ»æ³¢å½¢ã‚¢ãƒŠãƒ©ã‚¤ã‚¶ (PC/ã‚¹ãƒãƒ›ä¸¡å¯¾å¿œ)</title>
    <style>
        /* å…¨ä½“ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            text-align: center; 
            color: #333; 
            margin: 0;
            padding: 10px;
            background-color: #f4f4f4;
        }

        h1 { font-size: 1.5rem; margin: 10px 0; }
        p { font-size: 0.9rem; color: #666; margin-bottom: 15px; }

        /* æ“ä½œãƒ‘ãƒãƒ« */
        .controls { 
            background-color: #fff;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            display: inline-block;
            max-width: 100%;
        }

        /* ãƒœã‚¿ãƒ³ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« (ã‚¿ãƒƒãƒã—ã‚„ã™ã„ã‚µã‚¤ã‚ºã«) */
        button {
            padding: 10px 16px; /* ã‚¿ãƒƒãƒ—é ˜åŸŸã‚’åºƒã */
            font-size: 0.95rem;
            cursor: pointer;
            margin: 5px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            touch-action: manipulation; /* ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã‚ºãƒ¼ãƒ é˜²æ­¢ */
            transition: background-color 0.2s, transform 0.1s;
        }
        button:active { transform: scale(0.98); }
        button:hover { background-color: #f9f9f9; }
        button:disabled { color: #ccc; cursor: not-allowed; border-color: #eee; background-color: #fafafa; }

        /* è§£æãƒœã‚¿ãƒ³ */
        #startButton { background-color: #e3f2fd; border-color: #2196f3; color: #0d47a1; font-weight: bold; }
        #stopButton { background-color: #ffebee; border-color: #ef5350; color: #c62828; }

        /* ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒœã‚¿ãƒ³ã®è‰²åˆ†ã‘ */
        .btn-snap-1 { border-color: #ef9a9a; color: #d32f2f; }
        .btn-snap-1.active { background-color: #d32f2f; color: white; border-color: #b71c1c; }
        
        .btn-snap-2 { border-color: #90caf9; color: #1976d2; }
        .btn-snap-2.active { background-color: #1976d2; color: white; border-color: #0d47a1; }
        
        .btn-snap-3 { border-color: #ffcc80; color: #f57c00; }
        .btn-snap-3.active { background-color: #f57c00; color: white; border-color: #e65100; }

        /* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        #result { 
            margin: 10px auto 20px; 
            padding: 15px;
            background: #fff;
            display: table; /* ä¸­å¤®å¯„ã›ã®ãŸã‚ */
            border-radius: 8px;
            font-size: 1.1rem; 
            font-weight: bold; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            min-width: 280px;
        }

        /* ã‚°ãƒ©ãƒ•ã‚³ãƒ³ãƒ†ãƒŠ (Flexboxã§ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–åŒ–) */
        .graph-container { 
            display: flex; 
            flex-wrap: wrap; /* ç”»é¢ãŒç‹­ã„ã¨æŠ˜ã‚Šè¿”ã™ */
            justify-content: center; 
            gap: 20px; 
            width: 100%;
        }

        /* å€‹ã€…ã®ã‚°ãƒ©ãƒ•ãƒœãƒƒã‚¯ã‚¹ */
        .graph-box {
            flex: 1 1 500px; /* åŸºæœ¬å¹…500px, ç‹­ããªã‚‹ã¨ç¸®ã‚€ */
            max-width: 100%; /* ã‚¹ãƒãƒ›ã§ã¯ç”»é¢å¹…ã„ã£ã±ã„ã« */
            background: #fff;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }

        h2 { font-size: 1rem; margin: 0 0 10px; color: #555; }

        /* Canvasã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        canvas {
            width: 100%; /* è¦ªè¦ç´ ã«åˆã‚ã›ã¦æ¨ªå¹…ã„ã£ã±ã„ */
            height: auto; /* é«˜ã•ã¯æ¯”ç‡ã‚’ç¶­æŒ */
            display: block;
            border: 1px solid #eee;
            background-color: #fafafa;
        }

        /* ã‚¹ãƒãƒ›å‘ã‘ã®å¾®èª¿æ•´ */
        @media (max-width: 600px) {
            h1 { font-size: 1.2rem; }
            .controls { padding: 10px; margin-bottom: 10px; }
            button { padding: 8px 12px; font-size: 0.85rem; margin: 3px; }
            #result { font-size: 1rem; width: 90%; }
            .graph-box { padding: 5px; }
        }
    </style>
</head>
<body>
    <h1>ğŸ¤ éŸ³ã®å‘¨æ³¢æ•°ãƒ»æ³¢å½¢ã‚¢ãƒŠãƒ©ã‚¤ã‚¶</h1>
    <p>ãƒã‚¤ã‚¯å…¥åŠ›ã§éŸ³ã®æˆåˆ†ã¨æ³¢å½¢ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚<br>ã‚¹ãƒãƒ›ã¯æ¨ªç”»é¢æ¨å¥¨ã§ã™ã€‚</p>

    <div class="controls">
        <div style="margin-bottom: 10px;">
            <button id="startButton">â–¶ é–‹å§‹</button>
            <button id="stopButton" disabled>â–  åœæ­¢</button>
            <button id="clearAllBtn" disabled>å…¨ã‚¯ãƒªã‚¢</button>
        </div>
        <div>
            <button id="snapBtn1" class="btn-snap-1" disabled>ãƒ‡ãƒ¼ã‚¿1 (èµ¤)</button>
            <button id="snapBtn2" class="btn-snap-2" disabled>ãƒ‡ãƒ¼ã‚¿2 (é’)</button>
            <button id="snapBtn3" class="btn-snap-3" disabled>ãƒ‡ãƒ¼ã‚¿3 (æ©™)</button>
        </div>
    </div>

    <div id="result">
        å‘¨æ³¢æ•°: --- Hz<br>
        éŸ³ç¨‹: --- / ---
    </div>

    <div class="graph-container">
        <div class="graph-box">
            <h2>å‘¨æ³¢æ•°ã‚¹ãƒšã‚¯ãƒˆãƒ« (æŒ¯å‹•æ•°)</h2>
            <canvas id="freqGraph"></canvas>
        </div>
        <div class="graph-box">
            <h2>æ™‚é–“æ³¢å½¢ (æŒ¯å¹…ã®æ§˜å­)</h2>
            <canvas id="timeGraph"></canvas>
        </div>
    </div>

    <script>
        // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° ---
        let audioContext;
        let analyser;
        let source;
        let rafId; 
        
        let freqDataArray; 
        let timeDataArray; 
        let currentDetectedFreq = 0; 

        // ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ (3ã¤åˆ†)
        const snapshots = [
            { freq: null, time: null, active: false, color: 'rgba(255, 0, 0, 0.7)' },
            { freq: null, time: null, active: false, color: 'rgba(0, 0, 255, 0.6)' },
            { freq: null, time: null, active: false, color: 'rgba(255, 140, 0, 0.7)' }
        ];

        // UIè¦ç´ 
        const canvasElems = {
            freq: document.getElementById('freqGraph'),
            time: document.getElementById('timeGraph')
        };
        const canvasCtxs = {
            freq: canvasElems.freq.getContext('2d'),
            time: canvasElems.time.getContext('2d')
        };
        const resultDiv = document.getElementById('result');
        const buttons = {
            start: document.getElementById('startButton'),
            stop: document.getElementById('stopButton'),
            snaps: [
                document.getElementById('snapBtn1'),
                document.getElementById('snapBtn2'),
                document.getElementById('snapBtn3')
            ],
            clear: document.getElementById('clearAllBtn')
        };

        // å®šæ•°
        const A4_FREQ = 440;
        const HALF_STEP = Math.pow(2, 1/12); 
        const NOTE_NAMES_INTL = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
        const NOTE_NAMES_JAPANESE = ["ãƒ‰", "ãƒ‰#", "ãƒ¬", "ãƒ¬#", "ãƒŸ", "ãƒ•ã‚¡", "ãƒ•ã‚¡#", "ã‚½", "ã‚½#", "ãƒ©", "ãƒ©#", "ã‚·"];
        
        const MIN_FREQ_DISPLAY = 20; 
        const MAX_FREQ_DISPLAY = 8000; 
        const TICK_FREQS = [20, 50, 100, 200, 400, 800, 1600, 3200, 6400];

        // --- åˆæœŸåŒ– ---
        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºãŒå¤‰ã‚ã£ãŸã‚‰Canvasã‚µã‚¤ã‚ºã‚’èª¿æ•´
        window.addEventListener('resize', resizeCanvas);
        // åˆæœŸãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚‚ã‚µã‚¤ã‚ºèª¿æ•´ã‚’å®Ÿè¡Œ
        resizeCanvas();

        buttons.start.onclick = startAnalysis;
        buttons.stop.onclick = stopAnalysis;
        buttons.clear.onclick = clearAllSnapshots;

        buttons.snaps.forEach((btn, index) => {
            btn.onclick = () => toggleSnapshot(index);
        });

        // --- Canvasãƒªã‚µã‚¤ã‚ºå‡¦ç† ---
        function resizeCanvas() {
            // è¦ªè¦ç´ (.graph-box)ã®å¹…ã‚’å–å¾—
            const boxWidth = document.querySelector('.graph-box').clientWidth;
            // ä½™ç™½ç­‰ã‚’è€ƒæ…®ã—ã¦Canvaså¹…ã‚’è¨­å®š
            // ç¸¦æ¨ªæ¯”ã‚’ç¶­æŒ (ä¾‹: 2:1)
            const newWidth = boxWidth - 20; // paddingåˆ†ã‚’å¼•ã
            const newHeight = newWidth * 0.5; 

            // å¹…ãŒå°ã•ããªã‚Šã™ããªã„ã‚ˆã†ã«åˆ¶é™
            const finalWidth = Math.max(newWidth, 300);
            const finalHeight = Math.max(newHeight, 180);

            // Canvasã®å†…éƒ¨è§£åƒåº¦ã‚’æ›´æ–° (ã“ã‚Œã§æç”»ãŒã‚¯ãƒªã‚¢ã«ãªã‚‹)
            canvasElems.freq.width = finalWidth;
            canvasElems.freq.height = finalHeight;
            canvasElems.time.width = finalWidth;
            canvasElems.time.height = finalHeight;

            // ãƒªã‚µã‚¤ã‚ºç›´å¾Œã«å†æç”»ã—ãªã„ã¨ã€è§£æåœæ­¢ä¸­ã¯çœŸã£ç™½ã«ãªã‚‹ãŸã‚
            if (!rafId && (snapshots.some(s => s.active) || freqDataArray)) {
                // åœæ­¢ä¸­ã‹ã¤ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯ä¸€åº¦ã ã‘æç”»
                requestAnimationFrame(() => {
                    drawFrequencyGraph();
                    drawTimeDomainGraph();
                });
            }
        }

        // --- è§£æé–‹å§‹ ---
        async function startAnalysis() {
            try {
                // AudioContextã®å†é–‹ (ãƒ¢ãƒã‚¤ãƒ«Safariå¯¾ç­–)
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (!audioContext) audioContext = new AudioContext();
                if (audioContext.state === 'suspended') await audioContext.resume();

                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        echoCancellation: false, // åŸéŸ³ã«å¿ å®Ÿã«ã™ã‚‹ãŸã‚ã‚¨ã‚³ãƒ¼ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãªã©ã¯OFFæ¨å¥¨
                        noiseSuppression: false,
                        autoGainControl: false 
                    } 
                });

                analyser = audioContext.createAnalyser();
                source = audioContext.createMediaStreamSource(stream);
                
                analyser.fftSize = 2048; 
                analyser.smoothingTimeConstant = 0.85; 

                timeDataArray = new Uint8Array(analyser.fftSize); 
                freqDataArray = new Uint8Array(analyser.frequencyBinCount); 
                
                source.connect(analyser);

                // UIæ›´æ–°
                buttons.start.disabled = true;
                buttons.stop.disabled = false;
                buttons.clear.disabled = false;
                buttons.snaps.forEach(btn => btn.disabled = false);
                
                draw();

            } catch (err) {
                console.error(err);
                alert('ãƒã‚¤ã‚¯ã®ã‚¢ã‚¯ã‚»ã‚¹ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\nãƒ»ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\nãƒ»HTTPSã¾ãŸã¯localhostã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚');
            }
        }

        // --- è§£æåœæ­¢ ---
        function stopAnalysis() {
            cancelAnimationFrame(rafId);
            rafId = null;
            if (source) {
                source.disconnect();
                source = null; // å‚ç…§ã‚’åˆ‡ã‚‹
            }
            // AudioContextã¯closeã›ãšsuspendã«ã™ã‚‹æ–¹ãŒå†é–‹ãŒæ—©ã„
            if (audioContext) audioContext.suspend();
            
            buttons.start.disabled = false;
            buttons.stop.disabled = true;
            buttons.clear.disabled = true;
            buttons.snaps.forEach(btn => btn.disabled = true);
            
            currentDetectedFreq = 0; 
            resultDiv.innerHTML = "å‘¨æ³¢æ•°: --- Hz<br>éŸ³ç¨‹: --- / ---";
        }

        // --- ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå‡¦ç† ---
        function toggleSnapshot(index) {
            const snap = snapshots[index];
            const btn = buttons.snaps[index];

            if (!snap.active) {
                if (freqDataArray && timeDataArray) {
                    snap.freq = new Uint8Array(freqDataArray);
                    snap.time = new Uint8Array(timeDataArray);
                    snap.active = true;
                    btn.classList.add('active');
                    btn.textContent = `ãƒ‡ãƒ¼ã‚¿${index + 1} æ¶ˆå»`;
                }
            } else {
                snap.freq = null;
                snap.time = null;
                snap.active = false;
                btn.classList.remove('active');
                btn.textContent = `ãƒ‡ãƒ¼ã‚¿${index + 1} (${['èµ¤','é’','æ©™'][index]})`;
            }
        }

        function clearAllSnapshots() {
            snapshots.forEach((snap, index) => {
                snap.freq = null;
                snap.time = null;
                snap.active = false;
                const btn = buttons.snaps[index];
                btn.classList.remove('active');
                btn.textContent = `ãƒ‡ãƒ¼ã‚¿${index + 1} (${['èµ¤','é’','æ©™'][index]})`;
            });
        }

        // --- æç”»ãƒ«ãƒ¼ãƒ— ---
        function draw() {
            rafId = requestAnimationFrame(draw);

            if(analyser) {
                analyser.getByteFrequencyData(freqDataArray); 
                analyser.getByteTimeDomainData(timeDataArray); 
                currentDetectedFreq = detectPitch(freqDataArray, audioContext.sampleRate, analyser.frequencyBinCount);
            }
            
            drawFrequencyGraph();
            drawTimeDomainGraph(); 
            
            displayResult(currentDetectedFreq);
        }

        function freqToX(freq, width) {
            const clampedFreq = Math.max(freq, MIN_FREQ_DISPLAY); 
            const logMin = Math.log10(MIN_FREQ_DISPLAY);
            const logMax = Math.log10(MAX_FREQ_DISPLAY);
            const logFreq = Math.log10(clampedFreq);
            return (logFreq - logMin) / (logMax - logMin) * width;
        }

        // --- 1. å‘¨æ³¢æ•°ã‚°ãƒ©ãƒ•æç”» ---
        function drawFrequencyGraph() {
            const ctx = canvasCtxs.freq;
            const width = canvasElems.freq.width;
            const height = canvasElems.freq.height;
            // audioContextãŒãªã„(åœæ­¢ä¸­)ã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ44100ãªã©ã§è¨ˆç®—
            const sampleRate = audioContext ? audioContext.sampleRate : 44100;
            const fftSize = analyser ? analyser.fftSize : 2048;
            const freqResolution = sampleRate / fftSize;
            
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, width, height);

            // ç›®ç››ã‚Š
            ctx.strokeStyle = '#eee'; 
            ctx.fillStyle = '#888'; 
            ctx.font = '11px sans-serif';
            ctx.textAlign = 'center';
            ctx.lineWidth = 1;

            TICK_FREQS.forEach(f => {
                const x = freqToX(f, width);
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
                if (x > 15 && x < width - 15) ctx.fillText(`${f}`, x, height - 5);
            });
            
            // ãƒ‡ãƒ¼ã‚¿ãŒãªã‘ã‚Œã°çµ‚äº†
            if (!freqDataArray && !snapshots.some(s=>s.active)) return;

            const binCount = analyser ? analyser.frequencyBinCount : 1024;
            const startIndex = Math.floor(MIN_FREQ_DISPLAY / freqResolution); 
            const maxBinToDisplay = Math.min(binCount, Math.ceil(MAX_FREQ_DISPLAY / freqResolution));

            // ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæç”»
            snapshots.forEach(snap => {
                if (snap.active && snap.freq) {
                    drawSingleFreqLine(ctx, snap.freq, width, height, freqResolution, startIndex, maxBinToDisplay, snap.color, 2);
                }
            });

            // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»
            if (analyser && rafId) {
                drawSingleFreqLine(ctx, freqDataArray, width, height, freqResolution, startIndex, maxBinToDisplay, '#333', 2);
                
                // èµ¤ç‚¹ (åŸºéŸ³)
                if (currentDetectedFreq > MIN_FREQ_DISPLAY && currentDetectedFreq < MAX_FREQ_DISPLAY) {
                    const detectedX = freqToX(currentDetectedFreq, width);
                    const detectedIndex = Math.round(currentDetectedFreq / freqResolution);
                    let detectedY = height;
                    if(detectedIndex < freqDataArray.length) {
                        detectedY = height - (freqDataArray[detectedIndex] / 255 * height);
                    }
                    ctx.fillStyle = 'red';
                    ctx.beginPath();
                    ctx.arc(detectedX, detectedY, 6, 0, Math.PI * 2, false); 
                    ctx.fill();
                }
            }
        }

        function drawSingleFreqLine(ctx, data, width, height, resolution, startIndex, maxIndex, color, lineWidth) {
            ctx.lineWidth = lineWidth;
            ctx.strokeStyle = color;
            ctx.beginPath();
            let hasStarted = false;
            for (let i = startIndex; i < maxIndex; i++) {
                const x = freqToX(i * resolution, width);
                const y = height - (data[i] / 255 * height);
                if (!hasStarted) { ctx.moveTo(x, y); hasStarted = true; } 
                else { ctx.lineTo(x, y); }
            }
            ctx.stroke();
        }

        // --- 2. æ™‚é–“æ³¢å½¢ã‚°ãƒ©ãƒ•æç”» ---
        function drawTimeDomainGraph() {
            const ctx = canvasCtxs.time;
            const width = canvasElems.time.width;
            const height = canvasElems.time.height;

            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, width, height);

            // ã‚»ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¤ãƒ³
            ctx.strokeStyle = '#eee';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, height / 2);
            ctx.lineTo(width, height / 2);
            ctx.stroke();

            // ãƒ‡ãƒ¼ã‚¿ãŒãªã‘ã‚Œã°çµ‚äº†
            if (!timeDataArray && !snapshots.some(s=>s.active)) return;

            // ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæç”»
            snapshots.forEach(snap => {
                if (snap.active && snap.time) {
                    drawSingleWaveLine(ctx, snap.time, width, height, snap.color, 2);
                }
            });

            // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»
            if (analyser && rafId) {
                drawSingleWaveLine(ctx, timeDataArray, width, height, '#333', 2);
            }
        }

        function drawSingleWaveLine(ctx, data, width, height, color, lineWidth) {
            ctx.lineWidth = lineWidth;
            ctx.strokeStyle = color;
            ctx.beginPath();

            const sliceWidth = width * 1.0 / data.length;
            let x = 0;
            const amplitudeScale = 0.8; 

            for (let i = 0; i < data.length; i++) {
                const v = data[i]; 
                const normalized = (v - 128) / 128.0;
                const y = (height / 2) - (normalized * (height / 2) * amplitudeScale);

                if (i === 0) { ctx.moveTo(x, y); } 
                else { ctx.lineTo(x, y); }
                x += sliceWidth;
            }
            ctx.stroke();
        }

        // --- ãƒ”ãƒƒãƒæ¤œå‡º & éŸ³ç¨‹è¨ˆç®— ---
        function detectPitch(data, sampleRate, binCount) {
            let maxIndex = -1;
            let maxValue = 0;
            const maxCheckIndex = Math.floor(binCount * 0.2); 
            for (let i = 0; i < maxCheckIndex; i++) {
                if (data[i] > maxValue && data[i] > 100) { 
                    maxValue = data[i];
                    maxIndex = i;
                }
            }
            if (maxIndex !== -1) return maxIndex * (sampleRate / analyser.fftSize); 
            return 0; 
        }

        function freqToNote(freq) {
            if (freq === 0) return {intl: "---", jpn: "---", cent: "---"};
            const n = Math.round(12 * Math.log2(freq / A4_FREQ)) + 49; 
            const octave = Math.floor(n / 12) - 1;
            const noteIndex = (n % 12 + 12) % 12; 
            return {
                intl: NOTE_NAMES_INTL[noteIndex] + octave, 
                jpn: NOTE_NAMES_JAPANESE[noteIndex] + octave, 
                cent: `${Math.floor(1200 * Math.log2(freq / (A4_FREQ * Math.pow(HALF_STEP, n - 49))))} cent`
            };
        }

        function displayResult(freq) {
            const noteData = freqToNote(freq);
            const freqStr = freq > 0 ? `${freq.toFixed(2)}` : "---";
            resultDiv.innerHTML = `å‘¨æ³¢æ•°: ${freqStr} Hz<br>éŸ³ç¨‹: ${noteData.intl} (${noteData.jpn}) / ${noteData.cent}`;
        }
    </script>
</body>
</html>
